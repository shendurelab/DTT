We employed three steps to associate cells obtained from sci-RNA-seq3 with their respective gastruloid origins. 

First, we isolated reads that aligned with the Tape sequence reference for each individual cell. Subsequently, we extracted the TapeBC along with the six editing outcomes, noting that the majority exhibited edits in only a subset of the six results rather than all six. Following that, we proceeded with TapeBC correction within individual cells. If two TapeBCs displayed identical editing outcomes at the first site but varied by 1bp in their TapeBCs, we retained solely the TapeBC and its associated editing outcomes with the greater frequency of reads.

Second, we filtered out cells with fewer than three assigned TapeBCs. Subsequently, we mapped these retained cells to each individual gastruloid based on the TapeBCs obtained from the debris-seq for each respective gastruloid. Cells were assigned to the gastruloids with the highest overlap. In cases where two TapeBCs, one from sci-RNA-seq3 and one from debris-seq, exhibited a 1-bp mismatch but had identical editing outcomes at the first site, they were still considered as the same TapeBCs.

Third, certain cells were not uniquely assigned to a gastruloid; that is, they had multiple gastruloids with an equal number of overlapping TapeBCs. To solve this problem, we counted the number of shared TapeBCs between each pair of cells and converted it into a cell-cell distance using the formula 1/(the number of shared TapeBCs + 1) - 1. Similarly, in cases where two TapeBCs exhibited a 1-bp mismatch but had identical editing outcomes at the first site, they were still considered as the same TapeBCs. For each ambiguous cell, we compared its distance to those cells that were well-assigned in the second step, and then assigned it to the gastruloid with the minimum average distance across cells within that gastruloid.
